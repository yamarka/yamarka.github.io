<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Últimas Noticias</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Header -->
    <div id="header"></div>

    <!-- Cuerpo -->
    <div class="cuerpo">
        <h1 class="titulo">Últimas Noticias:</h1>
        <div class="noticias" id="noticias"></div>
    </div>

    <!-- Footer -->
    <div id="footer"></div>

    <!-- Scripts -->
    <script>
        // Obtener el header desde GitHub
        fetch('https://raw.githubusercontent.com/yamarka/yamarka.github.io/master/header.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('header').innerHTML = data;
            });

        // Obtener las últimas noticias desde el archivo JSON
        fetch('https://raw.githubusercontent.com/yamarka/yamarka.github.io/master/todaslasnoticias/todaslasnoticias.json')
            .then(response => response.json())
            .then(data => {
                // Filtrar las últimas 3 noticias y evitar duplicados
                const ultimasNoticias = data.reverse().reduce((acc, noticia) => {
                    if (!acc.some(item => item.titulo === noticia.titulo)) {
                        acc.push(noticia);
                    }
                    return acc.length < 3 ? acc : acc.slice(0, 3);
                }, []);

                // Mostrar las noticias en el cuerpo
                const noticiasContainer = document.getElementById('noticias');
                ultimasNoticias.forEach(noticia => {
                    const noticiaHTML = `
                        <div class="noticia">
                            <img class="imagen" src="${noticia.imagen}" alt="${noticia.titulo}">
                            <h2>${noticia.titulo}</h2>
                            <p class="contenido">${truncateText(noticia.contenido, 50)}</p>
                            <a class="leer-mas" href="${noticia.enlace_noticia}" target="_blank">Leer más</a>
                        </div>
                    `;
                    noticiasContainer.innerHTML += noticiaHTML;
                });
            });

        // Obtener el footer desde GitHub
        fetch('https://raw.githubusercontent.com/yamarka/yamarka.github.io/master/footer.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('footer').innerHTML = data;
            });

        // Función para truncar el texto
        function truncateText(text, limit) {
            const words = text.split(' ');
            if (words.length > limit) {
                return words.slice(0, limit).join(' ') + '...';
            }
            return text;
        }
    </script>
</body>
</html>

